<?xml version="1.0" encoding="UTF-8"?>

<knowledge>
	<title>Music piece form identification?</title>
	<description>This knowledge base helps a user with finding the form of a classical music piece</description>

    <goal name="has_form">
        <description>The piece has the following form:</description>

		<answer value="Symphony" youtube="jv2WJMVPQi8"><![CDATA[<b>Symphony</b> <br /> A symphony large symphonic musical
            composition piece which often consists of four distinct parts. It is played by a symphony orchestra
            consisting of: strings, woodwinds, brass and various percussion.]]>
        </answer>

        <answer value="Oratorio" youtube="jyFxGu9-CfA"><![CDATA[<b>Oratorio</b> <br /> An Oratorio tells a story from the bible.
            One person tells/sings the story while being accompanied by singers who have small roles and a choir who
            for instance take the role of the people. There can be orchestra. A famous example is a Passion,
            an Oratorio telling a story about Jesus. ]]>
        </answer>

		<answer value="Cantata">Cantata</answer>
		<answer value="Recitative">Recitative</answer>

		<answer value="Opera" youtube="x8OHbbmfnW8"><![CDATA[<b>Opera</b> <br /> AAn Opera tells a story,
            usually one from the classical period but sometimes more modern stories as well (almost never
            religious ones though). The story is sung by a soloist, accompanied by an orchestra and choir.
            The singing is musical like, dramatic with possibly bombastic orchestras. The soloists wear
            costumes and there are figurants. ]]>
		</answer>

		<answer value="Concerto">Concerto</answer>
		<answer value="Orchestral Suite">Orchestral Suite</answer>
		<answer value="Ouverture">Ouverture</answer>
		<answer value="Duet">Duet</answer>
		<answer value="String Quartet">String Quartet</answer>
		<answer value="Piano Quartet">Piano Quartet</answer>
		<answer value="Piano Trio">Piano Trio</answer>
		<answer value="Piano Quintet">Piano Quintet</answer>
		<answer value="Canon">Canon</answer>
		<answer value="Solo Music">Solo Music</answer>
		<answer value="Partita">Partita</answer>
		<answer value="Piano Sonata">Piano Sonata</answer>
		<answer value="Violin Sonata">Violin Sonata</answer>
		<answer value="Cello Sonata">Cello Sonata</answer>
		<answer>I don't know what form this piece has, sorry</answer>
	</goal>

<!-- /////////////////////////no singing / orchestra -->
	<rule>
		<description>It is a symphony</description>
		<if>
			<and>
				<fact name="has_orchestra">yes</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_structure">4parts</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Symphony</fact>
			</then>
	</rule>

	<rule>
		<description>It is a concerto</description>
		<if>
			<and>
				<fact name="has_orchestra">yes</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_structure">dialoque</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Concerto</fact>
			</then>
	</rule>

	<rule>
		<description>It is an orchestral suite</description>
		<if>
			<and>
				<fact name="has_orchestra">yes</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_structure">danceforms</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Orchestral Suite</fact>
			</then>
	</rule>

	<rule>
		<description>It is an ouverture</description>
		<if>
			<and>
				<fact name="has_orchestra">yes</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_structure">abstractof</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Ouverture</fact>
			</then>
	</rule>


<!-- /////////////////////////no singing / no orchestra -->



<!-- has single instrument -->

    <rule>
		<description>It is a piano sonata</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_instruments">soloinstrument</fact>
				<fact name="has_sonatastructure_piano">1</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Piano Sonata</fact>
			</then>
    </rule>

    <rule>
		<description>It is a partita</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_instruments">soloinstrument</fact>
				<fact name="has_partitastructure">1</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Partita</fact>
			</then>
    </rule>

<!-- has piano -->

	<rule>
		<description>It is a violin sonata</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_instruments">piano</fact>
				<fact name="has_violin">1</fact>
				<fact name="has_sonatastructure">1</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Violin Sonata</fact>
			</then>

	</rule>

    <rule>
		<description>It is a cello sonata</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_instruments">piano</fact>
				<fact name="has_violin">0</fact>
				<fact name="has_cello">1</fact>
				<fact name="has_sonatastructure">1</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Cello Sonata</fact>
			</then>
	</rule>


	<rule>
		<description>It is a piano trio</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_instruments">piano</fact>
				<fact name="has_violin">1</fact>
				<fact name="has_sonatastructure">0</fact>
				<fact name="has_cello">1</fact>
				<fact name="has_viola">0</fact>
            </and>
		</if>
			<then>
				<fact name="has_form">Piano Trio</fact>
			</then>
	</rule>

	<rule>
		<description>It is a piano quartet</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_instruments">piano</fact>
				<fact name="has_violin">1</fact>
				<fact name="has_sonatastructure">0</fact>
				<fact name="has_cello">1</fact>
				<fact name="has_viola">1</fact>
            </and>
		</if>
			<then>
				<fact name="has_form">Piano Quartet</fact>
			</then>
	</rule>

	<rule>
		<description>It is a piano quintet</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">no</fact>
				<fact name="has_instruments">piano</fact>
				<fact name="has_violin">2</fact>
				<fact name="has_viola">1</fact>
				<fact name="has_cello">1</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Piano Quintet</fact>
			</then>
	</rule>

<!--has no piano -->
	<rule>
		<description>It is a string quartet</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">no</fact>
				<fact name ="has_instruments">strings</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">String Quartet</fact>
			</then>
	</rule>

	<rule>
		<description>It is a duet</description>
		<if>
		    <or>
                <and>
                    <fact name="has_orchestra">no</fact>
                    <fact name="has_singing">no</fact>
                    <fact name="has_instruments">twoidentical</fact>
                </and>

                <and>
                    <fact name="has_orchestra">no</fact>
                    <fact name="has_singing">yes</fact>
                    <fact name="has_musicians_count">2</fact>
                </and>
			</or>

		</if>
			<then>
				<fact name="has_form">Duet</fact>
			</then>
	</rule>

<!-- /////////////////////////has singing / no orchestra -->

<!-- solo -->
	<rule>
		<description>It is a solo piece</description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">yes</fact>
				<fact name="has_musicians_count">1</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Solo Music</fact>
			</then>
	</rule>


<!-- canon -->
	<rule>
		<description>It is a canon </description>
		<if>
			<and>
				<fact name="has_orchestra">no</fact>
				<fact name="has_singing">yes</fact>
                <fact name="has_musicians_count">morethan2</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Canon</fact>
			</then>
	</rule>

<!-- /////////////////////////has singing / has orchestra -->

<!-- opera-->

<rule>
		<description>It is an opera piece</description>
		<if>
		    <or>
                <and>
                    <fact name="has_orchestra">yes</fact>
                    <fact name="has_singing">yes</fact>
                    <fact name="has_lyrics_subject">classical</fact>
                </and>

                <and>
                    <fact name="has_orchestra">yes</fact>
                    <fact name="has_singing">yes</fact>
                    <fact name="has_lyrics_subject">neither</fact>
                    <fact name="has_fit">costume</fact>
                </and>

			</or>
		</if>
			<then>
				<fact name="has_form">Opera</fact>
			</then>
	</rule>

<!-- recitative-->
<rule>
		<description>It is a recitative</description>
		<if>

                <and>
                    <fact name="has_orchestra">yes</fact>
                    <fact name="has_singing">yes</fact>
                    <fact name="has_lyrics_subject">neither</fact>
                    <fact name="has_fit">minimalorchestra</fact>
                </and>


		</if>
			<then>
				<fact name="has_form">Recitative</fact>
			</then>
	</rule>
<!-- religious -->
<rule>
		<description>It is an oratorio</description>
		<if>
			<and>
				<fact name="has_orchestra">yes</fact>
				<fact name="has_singing">yes</fact>
				<fact name="has_lyrics_subject">religious</fact>
			    <fact name="has_fit_rel">singsupport</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Oratorio</fact>
			</then>
	</rule>

	<rule>
		<description>It is a cantata</description>
		<if>
			<and>
				<fact name="has_orchestra">yes</fact>
				<fact name="has_singing">yes</fact>
				<fact name="has_lyrics_subject">religious</fact>
				<fact name="has_fit_rel">baroqueorchestra</fact>
			</and>
		</if>
			<then>
				<fact name="has_form">Cantata</fact>
			</then>
	</rule>


	<!--  ////////////////Questions -->


<!--  We start with the two questions that give us the most information:
        Does the piece have an orchestra? and Does the piece have singing?-->


	<question>
		<audio>soundbytes/instruments/orchestra.mp3</audio>
		<description><![CDATA[Do you hear an orchestra?<br />]]> </description>
		<option>
			<description>I do hear an orchestra</description>
			<then>
				<fact name="has_orchestra">yes</fact>
			</then>
		</option>
		<option>
			<description>I don't hear an orchestra</description>
			<then>
				<fact name="has_orchestra">no</fact>
			</then>
		</option>
	</question>

	<question>
	    <audio>soundbytes/instruments/singing.mp3</audio>
		<description>Do you hear singing?</description>
		<option>
			<description>I hear singing</description>
			<then>
				<fact name="has_singing">yes</fact>
			</then>
		</option>
		<option>
			<description>I don't hear singing</description>
			<then>
				<fact name="has_singing">no</fact>
			</then>
		</option>
	</question>

<!-- /////////////////////////no singing / has orchestra -->

	<question>
		<description>Which of the following structures fits best?</description>
		<option>
			<description>The piece has four parts( 1: changes, 2: calmer,3: 3/4 measure,4: final)</description>
			<then>
				<fact name="has_structure">4parts</fact>
			</then>
		</option>
		<option>
			<description>The piece is a dialoque between the different instruments</description>
			<then>
				<fact name="has_structure">dialoque</fact>
			</then>
		</option>
		<option>
			<description>The piece has a lot of different themes following each other.  </description>
			<then>
				<fact name="has_structure">abstractof</fact>
			</then>
		</option>
		<option>
			<description>The piece has different parts based on dance forms</description>
			<then>
				<fact name="has_structure">danceforms</fact>
			</then>
		</option>
	</question>


<!-- /////////////////////////no singing / no orchestra -->
    <question>
		<description>What instruments do you hear?</description>
		<option>
			<description>I hear a piano plus strings</description>
			<then>
				<fact name="has_instruments">piano</fact>
			</then>
		</option>
		<option>
			<description>I hear four string instruments(two violins, a viola and a cello)</description>
			<then>
				<fact name="has_instruments">strings</fact>
			</then>
		</option>
		<option>
			<description>I hear two identical instruments</description>
			<then>
				<fact name="has_instruments">twoidentical</fact>
			</then>
		</option>
		<option>
			<description>I hear one instrument</description>
			<then>
				<fact name="has_instruments">soloinstrument</fact>
			</then>
		</option>
	</question>



<!-- If there is a piano and strings we need to find out which string instruments are involved' -->


    <question>
    <audio>soundbytes/instruments/viola.mpeg</audio>
		<description>Do you hear viola?</description>
		<option>
			<description>I hear viola</description>
			<then>
				<fact name="has_viola">1</fact>
			</then>
		</option>
		<option>
			<description>I don't hear viola</description>
			<then>
				<fact name="has_viola">0</fact>
			</then>
		</option>
	</question>

    <question>
    <audio>soundbytes/instruments/violin.mpeg</audio>
    		<description>Do you hear violin(s)?</description>
		<option>
			<description>I hear one violin</description>
			<then>
				<fact name="has_violin">1</fact>
			</then>
		</option>
		<option>
			<description>I hear two violins</description>
			<then>
				<fact name="has_violin">2</fact>
			</then>
		</option>
		<option>
			<description>I don't hear a violin</description>
			<then>
				<fact name="has_violin">0</fact>
			</then>
		</option>
	</question>

	    <question>
    <audio>soundbytes/instruments/cello.mpeg</audio>
    		<description>Do you hear a cello?</description>
		<option>
			<description>I hear a cello</description>
			<then>
				<fact name="has_cello">1</fact>
			</then>
		</option>
		<option>
			<description>I don't hear a cello</description>
			<then>
				<fact name="has_cello">0</fact>
			</then>
		</option>
	</question>


	<!-- If it's piano and a cello or violin it likely is violin or cello sonata' -->
    <question>
		<description>Does the piece fit the following structure? Different movements, most commonly: 1: Development of theme, 2: Slow movement, 3: Closing movement</description>
		<option>
			<description>yes</description>
			<then>
				<fact name="has_sonatastructure">1</fact>
			</then>
		</option>
		<option>
			<description>no</description>
			<then>
				<fact name="has_sonatastructure">0</fact>
			</then>
		</option>
    </question>


	<!-- If it's a single instrument it likely is a piano sonata or a partita' -->

    <question>
		<description>Choose what fits best</description>
		<option>
			<description>The piece is played on piano and consists of three or four different movements</description>
			<then>
				<fact name="has_sonatastructure_piano">1</fact>
			</then>
		</option>
		<option>
			<description>The piece consists of two movements (A-A or A-B)</description>
			<then>
				<fact name="has_partitastructure">1</fact>
			</then>
		</option>
    </question>

<!-- /////////////////////////has singing / no orchestra -->

	 <question>
		<description>What is the amount of musicians you hear?</description>
		<option>
			<description>I hear one musician</description>
			<then>
				<fact name="has_musicians_count">1</fact>
			</then>
		</option>
		<option>
			<description>I hear two musicians</description>
			<then>
				<fact name="has_musicians_count">2</fact>
			</then>
		</option>
		<option>
			<description>I hear more than two musicians</description>
			<then>
				<fact name="has_musicians_count">morethan2</fact>
			</then>
		</option>
	</question>

<!-- /////////////////////////has singing / has orchestra -->

    <question>
		<description>What is the subject of the lyrics?</description>
		<option>
			<description>religious</description>
			<then>
				<fact name="has_lyrics_subject">religious</fact>
			</then>
		</option>
		<option>
			<description>A story from the classical period</description>
			<then>
				<fact name="has_lyrics_subject">classical</fact>
			</then>
		</option>
		<option>
			<description>neither of those</description>
			<then>
				<fact name="has_lyrics_subject">neither</fact>
			</then>
		</option>
	</question>

    <question>
		<description>Choose what fits best</description>
		<option>
			<description>The piece has a minimal orchestra, singer sings simple melodies</description>
			<then>
				<fact name="has_fit">minimalorchestra</fact>
			</then>
		</option>
		<option>
			<description>The singing is dramatical, there are possibly figurants in costumes</description>
			<then>
				<fact name="has_fit">costume</fact>
			</then>
		</option>
    </question>

    <question>
		<description>Choose what fits best</description>
		<option>
			<description>The piece has a baroque orchestra</description>
			<then>
				<fact name="has_fit_rel">baroqueorchestra</fact>
			</then>
		</option>
		<option>
			<description>one singer tells the story, supported by orchestra and other singers</description>
			<then>
				<fact name="has_fit_rel">singsupport</fact>
			</then>
		</option>
    </question>




</knowledge>
